import Head from 'next/head';
import Image from 'next/image';
import { MainStyled } from '@/styles/MainStyled';
import { useEffect, useState } from 'react';
import axios from 'axios';


interface DataProps {
  category: string,
  score: 80,
  icon: string,
};

export default function Home() {

  const [dataApi, setDataApi] = useState<DataProps[]>([]);

  useEffect(() => {
    const fetchData = async () => {
      try {
        const response = await axios.get<DataProps[]>("data.json");
        setDataApi(response.data);
      } catch (e) {
        console.error(e);
      };
    };
    fetchData();
  }, []);

  return (
    <>
      <Head>
        <meta charSet="utf-8" />
        <meta name="description" content="Generated by create next app" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="description" content="Results summary component, challenge from front-end mentor!" />
        <title>Results Summary</title>
      </Head>
      
      <MainStyled  suppressHydrationWarning={true}>
        <div className="container">
          <h1 className='sr-only'>welcome to my first project with nextjs</h1>
          <div className="result">
            <p className="res">Your Result</p>
            <div className="number_result">
              <p className="number"> {Math.floor(dataApi.reduce((num, accum) => num + accum.score, 0) / dataApi.length)} <span>of 100</span></p>
            </div>
            <h2>Great</h2>
            <p className='description'>You scored higher than 65% of the people who have taken these tests.</p>
          </div>
          <div className="summary">
            <h3>Summary</h3>
            <ul>
              <>
                {
                  dataApi && dataApi.map((data, index: number) => (
                    <li className={data.category} key={index}>
                      <div className="img_item">
                        <Image 
                          src={data.icon} 
                          alt="" 
                          width={20}
                          height={20}
                          aria-hidden="true"
                        />
                        <p>{data.category}</p>
                      </div>
                      <div className="number">
                        <p><span> {data.score} </span> <span className="total">/ 100</span></p>
                      </div>
                    </li>
                  ))
                }
              </>
            </ul>
            <a href="/">Continue</a>
          </div>
        </div>
      </MainStyled>
    </>
  )
}
